<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.threego.algo.common.mapper.CommonMapper">

    <!--
        페이지네이션 공통 SQL Fragment
        모든 Mapper에서 재사용 가능
    -->

    <!-- offset 자동 계산 -->
    <sql id="calculateOffset">
        <if test="page != null and size != null">
            <bind name="offset" value="page * size"/>
        </if>
    </sql>

    <!-- LIMIT/OFFSET 페이징 처리 -->
    <sql id="pagination">
        <if test="size != null and size > 0">
            LIMIT #{size}
            <if test="offset != null and offset >= 0">
                OFFSET #{offset}
            </if>
        </if>
    </sql>

    <!-- offset이 이미 계산된 경우 (bind 없이 바로 사용) -->
    <sql id="paginationWithoutBind">
        <if test="size != null and size > 0">
            LIMIT #{size}
            <if test="offset != null and offset >= 0">
                OFFSET #{offset}
            </if>
        </if>
    </sql>

</mapper>